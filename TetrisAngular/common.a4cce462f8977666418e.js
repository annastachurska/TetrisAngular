(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{wQ0e:function(t,e,i){"use strict";var n=i("z++U"),o=i("6blF"),r=i("mrSG"),s=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.scheduler=e,n.work=i,n.pending=!1,n}return r.c(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this},e.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),setInterval(t.flush.bind(t,this),i)},e.prototype.recycleAsyncId=function(t,e,i){if(void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var i=!1,n=void 0;try{this.work(t)}catch(o){i=!0,n=!!o&&o||new Error(o)}if(i)return this.unsubscribe(),n},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,i){return t.call(this)||this}return r.c(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(i("pugT").a)),a=function(){function t(e,i){void 0===i&&(i=t.now),this.SchedulerAction=e,this.now=i}return t.prototype.schedule=function(t,e,i){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(i,e)},t.now=function(){return Date.now()},t}(),h=new(function(t){function e(i,n){void 0===n&&(n=a.now);var o=t.call(this,i,function(){return e.delegate&&e.delegate!==o?e.delegate.now():n()})||this;return o.actions=[],o.active=!1,o.scheduled=void 0,o}return r.c(e,t),e.prototype.schedule=function(i,n,o){return void 0===n&&(n=0),e.delegate&&e.delegate!==this?e.delegate.schedule(i,n,o):t.prototype.schedule.call(this,i,n,o)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}},e}(a))(s),u=i("isby");function c(t){var e=t.subscriber,i=t.counter,n=t.period;e.next(i),this.schedule({subscriber:e,counter:i+1,period:n},n)}var l=function(t,e){return t+e*n.a.width},d=function(t){t.element.forEach(function(e,i){e.forEach(function(e,n){if(1===t.element[i][n]){var o=l(n+t.positionX,i+t.positionY);t.board[o]="white"}})})},f=function(t){for(var e=0;e<n.a.height;e++)for(var i=0;i<n.a.width;i++){var o=l(i,e);t.board[o]=1===t.matrix[e][i]?"black":"white"}},p=function(t){for(var e=w(t),i=e.length-1;i>=0;i--)for(var n=0;n<e[i].length;n++)if(1==e[i][n]&&1==t.matrix[t.positionY+i][t.positionX+n])return!0;return!1},m=function(t){for(var e=t.element.length-1;e>=0;e--)for(var i=0;i<t.element[e].length;i++)if(1===t.element[e][i]&&1===t.matrix[t.positionY+e][t.positionX+i-1])return!0;return!1},g=function(t){for(var e=t.element.length-1;e>=0;e--)for(var i=0;i<t.element[e].length;i++)if(1===t.element[e][i]&&1===t.matrix[t.positionY+e][t.positionX+i+1])return!0;return!1},w=function(t){for(var e=[],i=0;i<t.element[0].length;i++){for(var n=[],o=t.element.length-1;o>=0;o--)n.push(t.element[o][i]);e.push(n)}return e},b=[[[1],[1],[1],[1]],[[1,1],[1,1]],[[1,0],[1,1],[1,0]],[[0,1,0],[1,1,1],[0,1,0]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1]]],v=function(t){var e=Math.floor(9*Math.random());t.elementNumber=e,t.element=b[e]},S=function(t){t.element.forEach(function(e,i){e.forEach(function(e,n){if(1===t.element[i][n]){var o=l(n+t.positionX,i+t.positionY);t.board[o]=8===t.elementNumber?"red":"black"}})})},y=function(t,e,i){!1===e.isFinished&&(e.gameInterval=function(t,e){var i;return void 0===t&&(t=0),void 0===e&&(e=h),i=t,(Object(u.a)(i)||!(i-parseFloat(i)+1>=0)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=h),new o.a(function(i){return i.add(e.schedule(c,t,{subscriber:i,counter:0,period:t})),i})}(t),e.gameCounterSubscription=e.gameInterval.subscribe(function(t){(function(t,e){t.positionY+1<=n.a.height-t.element.length&&!function(t){for(var e=t.element.length-1;e>=0;e--)for(var i=0;i<t.element[0].length;i++)if(1===t.element[e][i]&&1===t.matrix[t.positionY+e+1][t.positionX+i])return!0;return!1}(t)?(d(t),t.positionY+=1,S(t)):(0===t.positionY&&(t.isFinished=!0,function(t,e){t.gameCounterSubscription.unsubscribe(),e.navigate(["finish"])}(t,e)),8===t.elementNumber?function(t){var e=t.matrix;[[t.positionY-1,t.positionX-1],[t.positionY-1,t.positionX],[t.positionY-1,t.positionX+1],[t.positionY,t.positionX-1],[t.positionY,t.positionX],[t.positionY,t.positionX+1],[t.positionY+1,t.positionX-1],[t.positionY+1,t.positionX],[t.positionY+1,t.positionX+1]].forEach(function(t){t[0]>=0&&t[0]<n.a.height&&t[1]>=0&&t[1]<n.a.width&&(e[t[0]][t[1]]=0)}),t.matrix=e,f(t)}(t):function(t){t.element.forEach(function(e,i){e.forEach(function(e,n){1===t.element[i][n]&&(t.matrix[i+t.positionY][n+t.positionX]=1)})})}(t),function(t){document.querySelector(".tetrisInfo_text").innerHTML="",function(t){for(var e=[],i=[],o=0;o<t.matrix.length;o++)if(t.matrix[o].reduce(function(t,e){return t+e})==t.matrix[o].length){e.push(1);var r=new Array(n.a.width).fill(0);i.push(r),t.points++}else e.push(0);if(e.reduce(function(t,e){return t+e})>0){for(o=0;o<t.matrix.length;o++)0==e[o]&&i.push(t.matrix[o]);t.matrix=i,f(t)}}(t),t.positionY=0,t.positionX=Math.floor(n.a.width/2),t.element=function(t){var e=Math.floor(9*Math.random());return t.elementNumber=e,b[e]}(t),S(t)}(t))})(e,i),0===e.positionY&&(e.gameCounterSubscription.unsubscribe(),y(250,e,i))}))};i.d(e,"a",function(){return X});var X=function(){function t(t){this.router=t,this.tetrisWidthSize=200,this.tetrisHeightSize=200,this.rotateStyle="rotate(0deg)",this.gameState={matrix:null,positionX:Math.floor(Number(n.a.width/2)),positionY:0,element:null,elementNumber:null,points:0,isFinished:!1,board:null,gameInterval:null,gameCounterSubscription:null,isSwitchedSideKeys:!1,isRotateBtnClicked:!1,slowDownTimesToUse:4},this.tetrisHeightSize=20*n.a.height,this.tetrisWidthSize=20*n.a.width}return t.prototype.keyEvent=function(t){!0===this.gameState.isSwitchedSideKeys?function(e,i,o){switch(t.code){case"ArrowRight":e.positionX>=1&&!m(e)&&(d(e),e.positionX-=1,S(e));break;case"ArrowLeft":e.positionX<n.a.width-e.element[0].length&&!g(e)&&(d(e),e.positionX+=1,S(e));break;case"ArrowUp":e.positionX<=n.a.width-e.element.length&&e.positionY<=n.a.height-e.element[0].length&&!p(e)&&(d(e),e.element=w(e),S(e));break;case"ArrowDown":e.gameCounterSubscription.unsubscribe(),y(50,e,o)}}(this.gameState,0,this.router):function(e,i,o){switch(t.code){case"ArrowLeft":e.positionX>=1&&!m(e)&&(d(e),e.positionX-=1,S(e));break;case"ArrowRight":e.positionX<n.a.width-e.element[0].length&&!g(e)&&(d(e),e.positionX+=1,S(e));break;case"ArrowUp":e.positionX<=n.a.width-e.element.length&&e.positionY<=n.a.height-e.element[0].length&&!p(e)&&(d(e),e.element=w(e),S(e));break;case"ArrowDown":e.gameCounterSubscription.unsubscribe(),y(50,e,o)}}(this.gameState,0,this.router)},t.prototype.ngOnInit=function(){this.startGame()},t.prototype.ngOnDestroy=function(){t.finalPoints=this.gameState.points},t.prototype.startGame=function(){for(this.gameState.matrix=Array(n.a.height).fill(0).map(function(t){return Array(n.a.width).fill(0)}),v(this.gameState);8===this.gameState.elementNumber;)v(this.gameState);!function(t){t.board=Array(n.a.width*n.a.height).fill(0);for(var e=0;e<n.a.height;e++)for(var i=0;i<n.a.width;i++){var o=l(i,e);t.board[o]=1===t.matrix[e][i]?"black":"white"}}(this.gameState),S(this.gameState),y(250,this.gameState,this.router)},t.prototype.handleRotateButton=function(){this.gameState.isRotateBtnClicked=!this.gameState.isRotateBtnClicked,this.gameState.isSwitchedSideKeys=!this.gameState.isSwitchedSideKeys,this.rotateStyle=this.gameState.isRotateBtnClicked?"rotate(180deg)":"rotate(0deg)"},t.prototype.handleChageKeysButton=function(){this.gameState.isSwitchedSideKeys=0==this.gameState.isSwitchedSideKeys},t.prototype.handleSlowDownButton=function(){this.gameState.slowDownTimesToUse--,this.gameState.gameCounterSubscription.unsubscribe(),y(1e3,this.gameState,this.router)},t.finalPoints=-1,t}()}}]);